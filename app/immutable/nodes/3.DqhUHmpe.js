import{t as T,a as j}from"../chunks/CPFDW1bW.js";import{i as Ze}from"../chunks/DW3nCLgv.js";import{p as et,s as d,f as tt,e as it,g as _,u as s,r as c,i as de,t as B,j as we,k as H,l as Ie}from"../chunks/BrUV4KTp.js";import{e as g,s as oe}from"../chunks/Dey5Ezsi.js";import{e as R,i as J,P as Le,g as lt,a as at,b as st,t as nt,d as dt,r as w,s as U,c as C,f as A,h as ke}from"../chunks/DD0uYgO2.js";import{s as ot,a as F,b as m,c as D}from"../chunks/Bw2fyDt6.js";import{o as rt,w as Q}from"../chunks/DChc3i_k.js";var ut=T('<option class="svelte-1yuptal"> </option>'),ct=T('<div class="object history_item svelte-1yuptal"><div class="history_item_thumbnail svelte-1yuptal"><input class="history_item_qrcode svelte-1yuptal" type="image" src="./sampleqrcode.svg" alt="history item qrcode"> <img class="history_item_logo hidden svelte-1yuptal" alt="history item logo"></div> <div class="history_item_fields svelte-1yuptal"><input id="field1" class="history_item_field svelte-1yuptal" placeholder="field1" disabled> <input id="field2" class="history_item_field svelte-1yuptal" placeholder="field2" disabled> <input id="field3" class="history_item_field svelte-1yuptal" placeholder="field3" disabled> <input id="field4" class="history_item_field history_item_field_small svelte-1yuptal" placeholder="field4" disabled> <input id="field5" class="history_item_field history_item_field_small svelte-1yuptal" placeholder="field5" disabled></div> <input class="button history_item_use svelte-1yuptal" type="button" value="use"> <input class="button history_item_delete svelte-1yuptal" type="button" value="delete"></div>'),pt=T('<option class="svelte-1yuptal"> </option>'),ft=T('<div class="object list_item svelte-1yuptal"><div class="list_item_thumbnail svelte-1yuptal"><input class="list_item_qrcode svelte-1yuptal" type="image" src="./sampleqrcode.svg" alt="list item qrcode"> <img class="list_item_logo hidden svelte-1yuptal" alt="list item logo"></div> <div class="list_item_fields svelte-1yuptal"><input class="list_item_field svelte-1yuptal"> <input class="list_item_field svelte-1yuptal"> <input class="list_item_field svelte-1yuptal"> <input class="list_item_field list_item_field_small svelte-1yuptal"> <input class="list_item_field list_item_field_small svelte-1yuptal"></div> <select id="count" class="button list_item_count svelte-1yuptal"></select> <input class="button list_item_delete svelte-1yuptal" type="button" value="delete"></div>'),_t=T('<option class="svelte-1yuptal"> </option>'),vt=T('<div class="style_field svelte-1yuptal"><select id="option_font" class="button style_option svelte-1yuptal"></select> <input id="style_size" class="button style_option svelte-1yuptal" type="number" step="0.25" min="0" max="100"></div>'),mt=T('<link rel="preconnect" href="https://fonts.googleapis.com" class="svelte-1yuptal"> <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&amp;display=swap" rel="stylesheet" class="svelte-1yuptal"> <div id="main_div" class="stretch svelte-1yuptal"><div id="background_cover" class="stretch svelte-1yuptal"></div> <div id="left_div" class="svelte-1yuptal"><div id="input_container" class="container svelte-1yuptal"><div id="input" class="object svelte-1yuptal"><div id="input_thumbnail" class="svelte-1yuptal"><input id="input_qrcode" type="image" src="./sampleqrcode.svg" alt="input qrcode" class="svelte-1yuptal"> <div id="input_logo" class="hidden svelte-1yuptal"><img id="input_logo_image" class="stretch svelte-1yuptal" alt="input logo"> <input id="input_logo_button" type="file" accept="image/png, image/jpeg" class="svelte-1yuptal"></div></div> <div id="input_fields" class="svelte-1yuptal"><input id="input_field1" class="input_field svelte-1yuptal" placeholder="field1"> <input id="input_field2" class="input_field svelte-1yuptal" placeholder="field2"> <input id="input_field3" class="input_field svelte-1yuptal" placeholder="field3"> <input id="input_field4" class="input_field input_field_small svelte-1yuptal" placeholder="field4"> <input id="input_field5" class="input_field input_field_small svelte-1yuptal" placeholder="field5"></div> <select id="input_count" class="button svelte-1yuptal"></select> <input id="input_add" class="button svelte-1yuptal" type="button" value="add"></div></div> <div id="history_container" class="container svelte-1yuptal"><input id="history_search" class="object svelte-1yuptal" type="text" placeholder="Search"> <!></div></div> <div id="right_div" class="svelte-1yuptal"><div id="list_container" class="container svelte-1yuptal"></div> <div id="output_container" class="container svelte-1yuptal"><div id="output_main" class="object svelte-1yuptal"><input id="output_submit" class="button svelte-1yuptal" type="button" value="Submit!"> <input id="output_clear_list" class="button svelte-1yuptal" type="button" value="Clear list"></div> <div id="output_other" class="object svelte-1yuptal"><input id="output_options" class="button svelte-1yuptal" type="button" value="Options"></div></div></div></div> <div id="options_div" class="stretch hidden svelte-1yuptal"><div id="options_container" class="container svelte-1yuptal"><div id="style" class="object svelte-1yuptal"></div> <input id="option_font_button" class="button svelte-1yuptal" type="file"> <div id="option_thumbnail" class="svelte-1yuptal"><input id="option_thumbnail_range" class="button svelte-1yuptal" type="range" max="1" step="1" value="0"> <div id="option_thumbnail_display" class="svelte-1yuptal"></div></div> <div id="option_rotate" class="svelte-1yuptal"><input id="option_rotate_range" class="button svelte-1yuptal" type="range" max="270" step="90" value="0"> <div id="option_rotate_display" class="svelte-1yuptal"></div></div> <input id="option_export_history" class="button svelte-1yuptal" type="button" value="Export History" disabled> <input id="option_export_list" class="button svelte-1yuptal" type="button" value="Export list" disabled> <input id="option_reset" class="button svelte-1yuptal" type="button" value="Reset"> <input id="option_return" class="button svelte-1yuptal" type="button" value="Return"></div></div>',1);function qt(Be,Oe){et(Oe,!1);const[M,Ne]=ot(),y=()=>D(O,"$history",M),r=()=>D(x,"$list",M),p=()=>D(I,"$options",M),$=()=>D(z,"$fonts",M),o=()=>D(N,"$style",M),O=Q({}),x=Q({}),I=Q({}),z=Q({}),N=Q({});let n;rt(()=>{localStorage.history?F(O,JSON.parse(localStorage.history)):F(O,{}),localStorage.list?F(x,JSON.parse(localStorage.list)):F(x,{}),localStorage.options?F(I,JSON.parse(localStorage.options)):F(I,{}),localStorage.fonts?F(z,JSON.parse(localStorage.fonts)):fetch("./Montserrat-Regular.ttf").then(t=>t.blob().then(l=>{const e=new FileReader;e.onload=function(){e.result&&typeof e.result=="string"&&F(z,{Montserrat:{data:e.result,fallback:!0}})},e.readAsDataURL(l)})),localStorage.style?F(N,JSON.parse(localStorage.style)):(["field1","field2","field3","field4","field5"].forEach(t=>{m(N,s(o)[t]={font_name:"Montserrat",field_height:3.5,underline:!1},s(o))}),["field4","field5"].forEach(t=>{m(N,s(o)[t].field_height=2.75,s(o))})),x.subscribe(t=>localStorage.list=JSON.stringify(t)),O.subscribe(t=>localStorage.history=JSON.stringify(t)),I.subscribe(t=>localStorage.options=JSON.stringify(t)),z.subscribe(t=>localStorage.fonts=JSON.stringify(t)),N.subscribe(t=>localStorage.style=JSON.stringify(t)),n={qrcode:document.getElementById("input_qrcode"),logo:document.getElementById("input_logo"),field1:document.getElementById("input_field1"),field2:document.getElementById("input_field2"),field3:document.getElementById("input_field3"),field4:document.getElementById("input_field4"),field5:document.getElementById("input_field5"),count:document.getElementById("input_count")},p().last_field5&&(n.field5.value=p().last_field5),p().logo&&(document.getElementById("input_logo_image").src=p().logo),p().use_logo&&(n.qrcode.classList.add("hidden"),n.logo.classList.remove("hidden"))});function je(){n.field5.value&&m(I,s(p).last_field5=n.field5.value,s(p));const t=n.field1.value+n.field2.value+n.field3.value+n.field4.value+n.field5.value;let l=null;if(Object.entries(y()).forEach(([i,a])=>{a.field1+a.field2+a.field3+a.field4+a.field5===t&&(l=a)}),!l){const i=Math.random().toString(16).substring(2,16);m(O,s(y)[i]={qrcode:p().qrcode,field1:n.field1.value,field2:n.field2.value,field3:n.field3.value,field4:n.field4.value,field5:n.field5.value},s(y))}let e;if(Object.entries(r()).forEach(([i,a])=>{a.field1+a.field2+a.field3+a.field4===t&&(e=[i,a])}),e){const i=Number(r()[e[0]].count)+Number(n.count.value);i<100?m(x,s(r)[e[0]].count=String(i),s(r)):m(x,s(r)[e[0]].count=String(99),s(r))}else{const i=Math.random().toString(16).substring(2,16);m(x,s(r)[i]={qrcode:p().qrcode,field1:n.field1.value,field2:n.field2.value,field3:n.field3.value,field4:n.field4.value,field5:n.field5.value,count:n.count.value},s(r))}n.field1.value="",n.field2.value="",n.field3.value="",n.field4.value=""}function re(t){var l,e,i,a;(l=t.parentElement)!=null&&l.classList.contains("list_item")?(delete r()[(e=t.parentElement)==null?void 0:e.id],F(x,r())):(i=t.parentElement)!=null&&i.classList.contains("history_item")&&(delete y()[(a=t.parentElement)==null?void 0:a.id],F(O,y()))}function Te(t){if(!t)return;let l=t.currentTarget;for(let e in y()){let i=document.getElementById(e);i&&((y()[e].field1+y()[e].field2+y()[e].field3+y()[e].field4+y()[e].field5).toUpperCase().includes(l.value.toUpperCase())?i.style.display="":i.style.display="none")}}function $e(t){var i;let l=t.currentTarget;const e=y()[(i=l.parentElement)==null?void 0:i.id];n.field1.value=e.field1,n.field2.value=e.field2,n.field3.value=e.field3,n.field4.value=e.field4,n.field5.value=e.field5}function G(t){var f,h,S,E,b;if(!t)return;let l=t.currentTarget,e,i=(S=(h=(f=l.parentElement)==null?void 0:f.parentElement)==null?void 0:h.parentElement)==null?void 0:S.id,a=(b=(E=l.parentElement)==null?void 0:E.parentElement)==null?void 0:b.id;i.includes("history")?e=y()[a].qrcode:i.includes("list")?e=r()[a].qrcode:e=p().qrcode;const u=prompt("Enter QR Code value",e);u&&(i.includes("history")?m(O,s(y)[a].qrcode=u,s(y)):i.includes("list")?m(x,s(r)[a].qrcode=u,s(r)):m(I,s(p).qrcode=u,s(p)))}function Re(t){if(!t)return;let l=t.currentTarget;if(l.files){const e=l.files[0];if(e.size>5e6){alert("Image too large (>5MB)");return}if(e.type==="image/png"||e.type==="image/jpeg"){const i=new FileReader;i.onload=function(){if(i.result&&typeof i.result=="string"){const a=i.result;document.getElementById("input_logo_image").src=a,Object.entries(document.getElementsByClassName("list_item_logo")).forEach(([u,f])=>{f.src=a}),m(I,s(p).logo=a,s(p))}},i.readAsDataURL(e)}}}function Je(t){if(!t)return;let l=t.currentTarget;if(l.files){const e=l.files[0];if(e.size>2e6){alert("Font too large (>5MB)");return}else if($()[e.name]){alert("Font already in list");return}if([".ttf",".otf",".woff",".woff2"].includes(e.name.slice(e.name.lastIndexOf("."),e.name.length))){const i=new FileReader;i.onload=function(){if(i.result&&typeof i.result=="string"){const a=i.result;m(z,s($)[e.name]={data:a,fallback:!1},s($))}},i.readAsDataURL(e)}}}function Ae(t){var e,i,a,u;if(!t)return;const l=t;if(l.inputType==="insertFromPaste"){let f=[];if((e=l.data)!=null&&e.includes(`
`))f=(i=l.data)==null?void 0:i.split(`
`);else if((a=l.data)!=null&&a.includes("	"))f=(u=l.data)==null?void 0:u.split("	");else return;n.field1.value="";for(let h in f.slice(0,5)){const S=[n.field1,n.field2,n.field3,n.field4,n.field5];f[h]&&(S[h].value=f[h])}}}function Me(t){const l=document.querySelectorAll("#input_qrcode, .list_item_qrcode"),e=document.querySelectorAll("#input_logo, .list_item_logo");t?(e.forEach(i=>{i.classList.remove("hidden")}),l.forEach(i=>{i.classList.add("hidden")})):(l.forEach(i=>{i.classList.remove("hidden")}),e.forEach(i=>{i.classList.add("hidden")})),m(I,s(p).use_logo=t,s(p))}async function ze(){const t={basePdf:{width:100,height:20,padding:[0,0,0,0]},schemas:[[{name:"qrcodeField",type:"qrcode",position:{x:2,y:2},width:16,height:16},{name:"logoField",type:"image",position:{x:2,y:2},width:16,height:16},{name:"textField1",type:"text",position:{x:20,y:.5},width:80,height:o().field1.field_height,fontName:o().field1.font_name,dynamicFontSize:{min:1,max:100,fit:"vertical"},underline:o().field1.underline},{name:"textField2",type:"text",position:{x:20,y:1+o().field1.field_height},width:80,height:o().field2.field_height,fontName:o().field2.font_name,dynamicFontSize:{min:1,max:100,fit:"vertical"},underline:o().field2.underline},{name:"textField3",type:"text",position:{x:20,y:1.5+o().field1.field_height+o().field2.field_height},width:80,height:o().field3.field_height,fontName:o().field3.font_name,dynamicFontSize:{min:1,max:100,fit:"vertical"},underline:o().field3.underline},{name:"textField4",type:"text",position:{x:20,y:2+o().field1.field_height+o().field2.field_height+o().field3.field_height},width:80,height:o().field4.field_height,fontName:o().field4.font_name,dynamicFontSize:{min:1,max:100,fit:"vertical"},underline:o().field4.underline},{name:"textField5",type:"text",position:{x:20,y:2.5+o().field1.field_height+o().field2.field_height+o().field3.field_height+o().field4.field_height},width:80,height:o().field5.field_height,fontName:o().field5.font_name,dynamicFontSize:{min:1,max:100,fit:"vertical"},underline:o().field5.underline}]]},l=await Le.create();for(let a in Object.entries(r())){const u=Object.entries(r())[a][1];let f=[{qrcodeField:"",logoField:"",textField1:u.field1,textField2:u.field2,textField3:u.field3,textField4:u.field4,textField5:u.field5}];!n.logo.classList.contains("hidden")&&p().logo?f[0].logoField=p().logo:!n.qrcode.classList.contains("hidden")&&u.qrcode&&(f[0].qrcodeField=u.qrcode);const h=await lt({template:t,inputs:f,plugins:{text:nt,qrcode:st.qrcode,image:at},options:{font:$()}}),S=await Le.load(h),E=(await l.copyPages(S,[0]))[0];p().rotation&&E.setRotation(dt(p().rotation));for(let b=0;b<Number(u.count);b++)l.addPage(E)}const e=await l.save(),i=new Blob([e],{type:"application/pdf"});window.location.href=URL.createObjectURL(i)}Ze();var ue=mt(),K=d(tt(ue),4),V=d(_(K),2),W=_(V),ce=_(W),X=_(ce),pe=_(X),fe=d(pe,2),Pe=d(_(fe),2);c(fe),c(X);var Y=d(X,2),Ue=_(Y);de(8),c(Y);var Z=d(Y,2);R(Z,4,()=>Array.from(Array(100).keys()).slice(1,100),J,(t,l)=>{var e=ut(),i={},a=_(e,!0);c(e),B(u=>{i!==(i=u)&&(e.value=(e.__value=u)==null?"":u),oe(a,l)},[()=>String(l)],we),j(t,e)}),c(Z);var Ce=d(Z,2);c(ce),c(W);var _e=d(W,2),ve=_(_e),De=d(ve,2);R(De,1,()=>Object.entries(y()),J,(t,l)=>{let e=()=>H(l)[0];var i=ct(),a=_(i),u=_(a),f=d(u,2);c(a);var h=d(a,2),S=_(h);w(S);var E=d(S,2);w(E);var b=d(E,2);w(b);var q=d(b,2);w(q);var k=d(q,2);w(k),c(h);var L=d(h,2),se=d(L,2);c(i),B(()=>{U(i,"id",e()),U(f,"src",p().logo),C(S,y()[e()].field1),C(E,y()[e()].field2),C(b,y()[e()].field3),C(q,y()[e()].field4),C(k,y()[e()].field5)}),g("click",u,()=>G(event)),g("load",f,v=>{p().use_logo&&v.currentTarget.classList.remove("hidden")}),g("click",L,v=>$e(v)),g("click",se,v=>re(v.currentTarget)),j(t,i)}),c(_e),c(V);var me=d(V,2),ee=_(me);R(ee,5,()=>Object.entries(r()),J,(t,l)=>{let e=()=>H(l)[0];var i=ft(),a=_(i),u=_(a),f=d(u,2);c(a);var h=d(a,2),S=_(h);w(S);var E=d(S,2);w(E);var b=d(E,2);w(b);var q=d(b,2);w(q);var k=d(q,2);w(k),c(h);var L=d(h,2);B(()=>{r(),Ie(()=>{e()})}),R(L,4,()=>Array.from(Array(100).keys()).slice(1,100),J,(v,qe)=>{var P=pt(),Fe={},Ye=_(P,!0);c(P),B(ne=>{Fe!==(Fe=ne)&&(P.value=(P.__value=ne)==null?"":ne),oe(Ye,qe)},[()=>String(qe)],we),j(v,P)}),c(L);var se=d(L,2);c(i),B(()=>{U(i,"id",e()),U(f,"src",p().logo)}),g("click",u,()=>G(event)),g("load",f,v=>{p().use_logo&&v.currentTarget.classList.remove("hidden")}),A(S,()=>r()[e()].field1,v=>m(x,s(r)[e()].field1=v,s(r))),A(E,()=>r()[e()].field2,v=>m(x,s(r)[e()].field2=v,s(r))),A(b,()=>r()[e()].field3,v=>m(x,s(r)[e()].field3=v,s(r))),A(q,()=>r()[e()].field4,v=>m(x,s(r)[e()].field4=v,s(r))),A(k,()=>r()[e()].field5,v=>m(x,s(r)[e()].field5=v,s(r))),ke(L,()=>r()[e()].count,v=>m(x,s(r)[e()].count=v,s(r))),g("click",se,v=>re(v.currentTarget)),j(t,i)}),c(ee);var ye=d(ee,2),te=_(ye),ge=_(te),Qe=d(ge,2);c(te);var he=d(te,2),He=_(he);c(he),c(ye),c(me),c(K);var be=d(K,2),xe=_(be),ie=_(xe);R(ie,5,()=>Object.entries(o()),J,(t,l)=>{let e=()=>H(l)[0];var i=vt(),a=_(i);B(()=>{o(),Ie(()=>{e(),$()})}),R(a,5,()=>Object.entries($()),J,(f,h,S,E)=>{let b=()=>H(h)[0];var q=_t(),k={},L=_(q,!0);c(q),B(()=>{k!==(k=b())&&(q.value=(q.__value=b())==null?"":b()),oe(L,b())}),j(f,q)}),c(a);var u=d(a,2);w(u),c(i),B(()=>U(i,"id",`style_${e()??""}`)),ke(a,()=>o()[e()].font_name,f=>m(N,s(o)[e()].font_name=f,s(o))),A(u,()=>o()[e()].field_height,f=>m(N,s(o)[e()].field_height=f,s(o))),j(t,i)}),c(ie);var Se=d(ie,2),le=d(Se,2),Ge=_(le);de(2),c(le);var ae=d(le,2),Ke=_(ae);de(2),c(ae);var Ve=d(ae,2),We=d(Ve,2),Ee=d(We,2),Xe=d(Ee,2);c(xe),c(be),g("click",pe,()=>G(event)),g("change",Pe,t=>Re(t)),g("input",Ue,t=>Ae(t)),g("click",Ce,()=>je()),g("keyup",ve,t=>Te(t)),g("click",ge,()=>ze()),g("click",Qe,()=>{confirm("Clear list?")&&F(x,{})}),g("click",He,()=>{var t,l;(t=document.getElementById("main_div"))==null||t.classList.add("hidden"),(l=document.getElementById("options_div"))==null||l.classList.remove("hidden")}),g("change",Se,t=>Je(t)),g("input",Ge,t=>{let l=document.getElementById("option_thumbnail_display");l&&(t.currentTarget.value==="0"?l.innerText="qrcode":l.innerText="logo",Me(!!Number(t.currentTarget.value)))}),g("input",Ke,t=>{let l=document.getElementById("option_rotate_display");l&&(l.innerText=t.currentTarget.value),m(I,s(p).rotation=Number(t.currentTarget.value),s(p))}),g("click",Ee,()=>{confirm("Reset?")&&(localStorage.clear(),location.reload())}),g("click",Xe,()=>{var t,l;(t=document.getElementById("options_div"))==null||t.classList.add("hidden"),(l=document.getElementById("main_div"))==null||l.classList.remove("hidden")}),j(Be,ue),it(),Ne()}export{qt as component};
